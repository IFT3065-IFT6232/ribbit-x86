(define input "R8llac/pmuj,htgnel-rotcev,?=<gnirts,trats-tni-llac,raaaac,?=>rahc,raaadc,_,dna,?naeloob,$,!llif-rotcev,trats-tni-tsnoc,rdaadc,tes,trats-tni-teg,mcl,etouq,dnapxe-dnoc,xam,oludom,esle,trats-corp-tsnoc,radddc,dnoc,rts-ot-tuptuo-htiw,cc/llac,adbmal,rdaddc,rdadac,raadac,!tes-rotcev,trats-llac,tel,stropxe-xtc,?>rahc,rotaremun,?tsil,rddddc,roolf,trats-teg,yllamron-margorp-tixe,margorp-daer,ypoc-gnirts,enifed,yllamronba-margorp-tixe,gnirts-ekam,?evitagen,2/be,liat,gniliec,?=<rahc,trats-mys-teg,dnuor,elif-led,trats-mys-llac,trats-tni-tes,nim,rotanimoned,tropxe,trats-tes,trats-mys-pmuj,etacnurt,radaac,slobmys-denretninu,raddac,rdaaac,trats-mys-tsnoc,ro,trohs-mys-llac,reffub,rotcev-ekam,!tes-gnirts,qmem,fer-rav-labolg,raaddc,trats-tsnoc,rddadc,teg,*tel,tsnoc,nigeb,trats-mys-tes,!tes,edoc-tegrat-etirw,vne-erudecorp,trats-tni-pmuj,?=>gnirts,certel,trats-fi,radadc,!llif-gnirts,tibbir,dmc-llehs,lbtmys,!tes-rav-labolg,?<rahc,pool,rahc-etirw,?evitisop,?orez,rddaac,fer-rotcev,fi,sedoc>-gnirts,sfed-teser,tsil>-elbat,tros-tsil,enil-dmc,edoc-etareneg,?ddo,rahcteg,tpxe,noisnetxe-htap,?regetni,yrarbil-daer,dcg,elif-tupni-htiw-llac,lper,relipmoc-enilepip,htap-elbatucexe,elif-tpircs,ssenevil,sisylana-ssenevil,?=rahc,htgnel-elbat,gnirts-ot-tuptuo-htiw,dnibnu-neg,enil-daer,!tros-tsil,elif-morf-tupni-htiw,>,lobmys-denretninu>-gnirts,?qe,rebmun>-gnirts,margorp-elipmoc,vssa,?neve,?erudecorp,elipmoc,=<,lave,elif-ot-tuptuo-htiw,?>gnirts,redniamer,?<gnirts,!tes-evil-xtc,edocne,stropxe-tcartxe,xua-lobmys>-gnirts,tsil-dnapxe,xua-rebmun>-gnirts,xua-sisylana-ssenevil,stropxe-htiw-srpxe-pmoc,yrotcerid-htap,raadc,repo,rebmem,rahc>-regetni,xua-gnirtsbus,2xua-rebmun>-gnirts,xua-pmc-gnirts,radac,elbat-ekam,xua-rahc-daer,llac-neg,edoc-erudecorp,?=gnirts,xtc-ekam,*dnib-pmoc,?tnatsnoc,!tes-elbat,radc,gnirts>-lobmys,raaac,ngissa-neg,tnemmoc-piks,tsil-etirw,tsil-daer,?ni,tsila>-stropxe,llac-pmoc,rdaac,raac,xua-tsil-ekam,dnib-pmoc,rdadc,xua-esrever,raddc,xua-?tsil,evil>-stropxe,elif-morf-gnirts,liat-tsil,tixe,xua-dcg,evil-xtc,fer-tsil,lobmys>-gnirts,?2erudecorp,tnatsnoc-dnapxe,hcae-rof,lla-daer,poon-neg,ydob-dnapxe,lave-dnapxe-dnoc,pmc-gnirts,dnetxe,erudecorp-ekam,elif-morf-daer,!rac-tes,1tsil,xua-gnirts>-rebmun,lobmys-esu,3tsil,nigeb-dnapxe,rotcev>-tsil,2tsil,?rotcev,rdddc,tsil-ekam,sba,ecapsetihw-non-rahc-keep,!tes-tsil,regetni>-rahc,lobmys-daer,?gnirts,lobmys-denretninu>-rts,tsil>-rotcev,fer-elbat,gnirtsbus,tes-etc-xtc,cossa,!tes-2dleif,gnirts>-rebmun,enod-ydob-dnapxe,2rahctup,rdddac,?tcejbo-foe,?ecnatsni,daer,fer-gnirts,srahc-daer,etanetacnoc-gnirts,rts>-lobmys,rahc-keep,enilwen,pp,fi-dliub,?evil,sesualc-dnapxe-dnoc-dnapxe,*nigeb-dnapxe,!tes-1dleif,?llun,etirw,dnpo,etc-xtc,gnirts>-maerts,pukool,txen,qssa,!rdc-tes,tneitouq,evil-dda,srahc-etirw,?bir,nigeb-pmoc,=>,esrever,htgnel-gnirts,rorre,vmem,dneppa,=,gnirts>-tsil,rddac,xeh-daer,2dleif,?lobmys,tsil>-gnirts,!tes-0dleif,rahctup,*,htgnel,rpxe-dnapxe,hguorht-epip,ecalper-gnirts,setyb-ot-edoc-mvr,rid-toor,?lauqe,dnapxe-htap,rahc-daer,pam,yalpsid,1dleif,0dleif,rddc,pmoc,ton,<,+,-,rdac,dneppa-gnirts,?riap,esolc,rac,2gra,1gra,?vqe,rdc,snoc,di,lin,eurt,eslaf,bir;8U/!U/8:YU9YTMYS9ki$i$kiY\'y!V$8TFE8:by^8:_~UiY0^{!A7&i&kkC^[$E9>iX%Z%?aZKZ$h-_f7$IlfC^[$E7/fJldb7\'Il^~YU*Z@`h1Z@J`dh/70??h.ZKh.gh3h4_^Jh/c~Kk^zi$~YTHZ$gJf_|i$Z$aZ$_|!@9>`RYH_E9GYS#^z{!U9\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^LgCYAiXKiXDYAWiX;aWiY%_YAWiXLaWiWO_YAa_`iY-\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^Lg^~UiXAcBi$\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^LgCYAiXKiXDYAWiX;aWiY%_YAWiXLaWiWO_YAa_`iY-\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^Lg^~UiXAcBQiWKBQZ$^BQiX(~Z&ldGiXC\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^LgCYAiXKiXDYAWiX;aWiY%_YAWiXLaWiWO_YAa_`iY-\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^Lg^~UiXAcBi$\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^LgCYAiXKiXDYAWiX;aWiY%_YAWiXLaWiWO_YAa_`iY-\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^Lg^~UiXAcBQiWKBQZ$^BQiX(~Z&ldGYSCe~e_YSCTVGGGdiX0biX:\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^LgCYAiXKiXDYAWiX;aWiY%_YAWiXLaWiWO_YAa_`iY-\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^Lg^~UiXAcBi$\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^LgCYAiXKiXDYAWiX;aWiY%_YAWiXLaWiWO_YAa_`iY-\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^Lg^~UiXAcBQiWKBQZ$^BQiX(~Z&ldGiXC\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^LgCYAiXKiXDYAWiX;aWiY%_YAWiXLaWiWO_YAa_`iY-\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^Lg^~UiXAcBi$\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^LgCYAiXKiXDYAWiX;aWiY%_YAWiXLaWiWO_YAa_`iY-\'^YB_TVGGiX,eiXI\'^^~CUiX7e\'^YB_TVGGiX,eiXI\'^^~C^~^Lg^~UiXAcBQiWKBQZ$^BQiX(~Z&ldGYSCe~e_iY#~UiY)aYTA__@cDb}(!SC8U1E8U&i$^z^z!VN8OYS2`8OYS9~UiXB`YU3^{!U38S2^8S2TTViXJGiX.^~UiX8YU5^z!S28U$iS9^z!S9(YS9^\'i&~ZC^ZAy!?8T:CYU.8T:C^~^YU-y!U>8;YH_iS#z]08MR_E8T6^8T6vD~YNvS#^JvF^zz!TA7&i&`kC^[$E7&ca_C^[$E7&cg_C^[$E7$aC^[$E0GGZ0aiY.Z>iX#RaE8MZ%YH^Z=^zZ0XBi&IYD`YDeX?i&hR%7\'@^~i$0GGZ0aiY.Z>iX#RaE8MZ%YH^Z=^zZ0XBi&IYD`YDeX?i&hR%7\'@^~YT-iX&Z=D^~F^zi$70?h-a@eJlcBYGd^@aZNiY17.e@ca~^Z-hR%^D^D_~F_|i$7.e@ca70?h-a@eJlcBYGd^@a@^~^Z-hM^D^D_~F_|i$70?h-`@eJlcBYGd`ZNiY(70?h-`@eJlcBYGd`@^~^Z-hH_@_D^D_~i$7&ca_C^[$E7&cg_C^[$E7$aC^[$E0GGZ0aiY.Z>iX#RaE8MZ%YH^Z=^zZ0XBi&IYD`YDeX?i&hR%7\'@^~i$0GGZ0aiY.Z>iX#RaE8MZ%YH^Z=^zZ0XBi&IYD`YDeX?i&hR%7\'@^~YT-iX&Z=D^~F^zi$70?h-a@eJlcBYGd^@aZNiY17.e@ca~^Z-hR%^D^D_~F_|i$7.e@ca70?h-a@eJlcBYGd^@a@^~^Z-hM^D^D_~F_|i$70?h-`@eJlcBYGd`ZNiY(70?h-`@eJlcBYGd`@^~^Z-hH_@_D^D_~KiV3^~F_|i$YU;YU<h<E4X)_X(_{BX5h<BX1h<BYS:iXOE74n^z[$E88^@`3YD_vS[rz0~^YT7iXO^D^z[%E9#i&iXG9#_iX?7+X,?ciUMZ2`Z._~AwU?^7+CZ#_iX>7+CX/c^~YS<^7+CX3dX4_iV5~YI^7+CX4d_iW>7+C?cJ_iV,~Kv.^~X-^Z2`Z._~AwV(^7+CZ#_iX57+CX3dX4_iVD~YI^7+CX4d_iW;7+C?cJ_iVP~Ku^~X-^Z2`Z._~AwV*^7+CZ#_iX*7+CX3dX4_iV&~YI^7+CX4d_iV@~X-^Z2`Z._~AwW<^7+CZ#_iWM7+CCX4e_iVA7+CC?dJ_iW*~KiV3^X3^~YI^7+CX4d_iWG~X-^Z2`Z._9#_iX\'73d_iV;(cJ_k~Kv7^X2^~YI^73c_iUP~X,^Z2_~AZ.`k~AwWJ^YT8^~Z(^{[&E8U4^z[\'E7,X4d`JoiW47,?cJ`iW4~Ko_Z._O^YT.^{[(E72e_`\'^~YNk`?bJiVH^72e_`\'^~YNk`?b^~AcaIYEiVH__Z+iVH^|[)E7.a`^{[*E(``(@`Jl`~YNJliVH^D^X/a_|[+E(X0b`^|[,E88^ZLi$_h>z[-E\'i$76n^~AwW<_77l^BZ5_aBYGwV*aX8^76m^~CCi$77l^BZ5_aBYGwV*aX8^76m^~CCZ&k`~X-`77l^BZ5_aBYGwV*aX8^76m^~CC^~^YS<_77l^BZ5_aBYGwV*aX8^76m^~C^~^YI^~AwV(_76l^~AwV*_76k^~AwWJ_73^~AwU?_Z2_YT8^z[.E\'i$71Z.^BX0^~Z(^z[/E\'i$75^~YS<^\'i$9HJYJ`l^~YNm`95JP`l^~YNl`8GJO`l^~YNk`CC^BYT)`ahA:kkk\'i$9HJYJ`l^~YNm`95JP`l^~YNl`8GJO`l^~YNk`C^~^ZLi$_h?~YI^{[0E\'^BX4`^{[1E71Z.YT.^z[2E\'^BX4k^z[3E\'^BX6n^BX?_`[9Jlh8YS=GZGh8iX11^~^Z-h>^\'w&~Ai&^\'w%~Ai%^\'w$~Ai$^z[4k[5E9HX=X;YJ_^O^z[6E7%`h>C^[$E\'_7-XE:gbwW<_@bN`H_D^D^~F^{i$z[7E#X>bYJ`P_O^\'_~Ak^{[8E7%a@iX6C^[$E\'_7)CCb7)CCX-c_~i$7)CCb7)CCX-c_~CCKYJak7)CCb7)CCX-c_~CC^~^KP`k7)CCb7)CCX-c_~C^~^KO_k~^ZLi$_hFDD_@^~F^{i$[$E#::::h.XBngwW<X@kw#wWJlwV(kwV(HZ-iX6_wV({i$z[9E\'`[@?h@??`a_X?k^{[:E9#_iX@7@XA::fX;kw#wWJowV(YD_^ZM^~YS)^7@XA::fX;kw#wWJnwV(YD_^RYH_iS#~ZO^7?X@::eX:kw#wWJkwV(@_D^~F^#a_wV(#::eX:kw2wWJIbkwV(kwV(~Kk^~X*^#aX6m_wV(~YI^#bX7l_wV*X7^~CZ-h@_9#_iX@7@XA::fX;kw#wWJowV(YD_^ZM^~YS)^7@XA::fX;kw#wWJnwV(YD_^RYH_iS#~ZO^7?X@::eX:kw#wWJkwV(@_D^~F^#a_wV(#::eX:kw2wWJIbkwV(kwV(~Kk^~X*^#aX6m_wV(~YI^#bX7l_wV*X7^~C^~^YPiXH^{[;i&[<YT1i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i$i${!UMJJloiW4!W4JmiV5!V5JliW>!W>Jv.iV,!V,JmiVD!VDJliW;!W;JuiVP!VPJmiV&!V&JliV@!V@JkiV<!V<JmiVA!VAJliWG!WGJiV3iW*!W*JmiV;!V;JliUP!UPJv7k!V3IJJJJv4v7uov.vS#!VHZ+mvS#!U,\'cBX\'i%i&b[$E\'i$7)`@^BX+i$`D^~F^{[%E\'i$7+a_7.i$YS4c_YL`H_~AwW/^7+a@_~AwV\'^7.i$YOcR`i-YL`BX,bR_i1H_~AwW)^7-i$aZD_BX-i$aYL_BX-i$aH_~AwU?^\'i$70i$d_BZ,?@``^~^Z8h1_Bi$\'i$70i$d_BZ,?@``^~^Z8h1_BX/_~h17/i$c^~YSOc_YL`H_~AwV%^7-^H_~AwW9^D^~F^7,^\'i$~YSO`^~YI^|[&E\'i$8S:ZM_c~YS)^7)@^BX)D^~F^7*^~YI^z[\'E\'k[,Z*g^zi$i$i$i$|!SO5AZ/ka_^{!T*\'i$\'i$\'i$*DH_wW9~FH^~Z4N^~F@^z]8\'i$98@a_\'^~AD__D_~F_{]*(a^?i&^\'_~Z8`^{!U=7$_C^[$E\'i$7\'@^BZ,i&D^~F^zi$z!SD\'i&(YSD@_?i&DD^~F^z!T<7$Z*Z*Z*Z*YSDCi&7$Z*Z*Z*Z*YSDC^~^dw\'w.w,w+C^[$E7(^\'_~A`^YU,Le_bBYU=^zi${!U+\'^8T<a_~ZI_wUHYT<i&^{!T>\'i&(YT>@_YCD^~F^z]7\'_97a@_96a@^~CYS6D_97a@_96a@^~C^~^AD_wW5D^~F^{!S6*wUJ^5LYPR@`iS6i%~i$*wUJ^5LYPR@`iS6i%~AwV4D^~F^5YPR@`iS6i$~i$*wUJ^5LYPR@`iS6i%~i$*wUJ^5LYPR@`iS6i%~AwV4D^~F^5YPR@`iS6i$~AwWBD^~F^5YS6H^~i$*wUJ^5LYPR@`iS6i%~i$*wUJ^5LYPR@`iS6i%~AwV4D^~F^5YPR@`iS6i$~i$*wUJ^5LYPR@`iS6i%~i$*wUJ^5LYPR@`iS6i%~AwV4D^~F^5YPR@`iS6i$~AwWBD^~F^5YS6H^~Aw5D^~F^z]6\'_(_YC_97_@_~i$(_YC_97_@_~AwW8D_~F_96_@_~i$(_YC_97_@_~i$(_YC_97_@_~AwW8D_~F_96_@_~AwV\'D_~F_Z6a@_D^~F^{!S,8S;k-^(_wV\'~F@^~F^Z6i&^z]F8S,_8C??aZ%_wUN~F^{!S77%i&_C^[$E9FiXP_9F``7+?c?Na_@`7+?c??i&??Nc@awW/D_@`~F^H^~i$9F``7+?c?Na_@`7+?c??i&??Nc@awW/D_@`~F^H^~i$9F``7+?c?Na_@`7+?c??i&??Nc@awW/D_@`~F^H^~F@^~AD_wVL~F^D^~F^{i$z!S;(?i&_wW9z!C8S;^8T>_8Ci$8C????i&?NcwW2?@HbwV\'DH`wU?8C?@H`wV\'~ADH`wW5~F@_~AwW2^8Ci$8CH_8C???i&????i&?NewV4wWCwWCwU??i&??i&HawWCwW)~FN_~F@_~AwV4^8Ci%8CH_8C????i&i$?NbwWBH`wU?~FN_~F@_~AwWB^(??i&YCYLb_wV%(??i&YC??Nd@awW/D_wV%~F^H_~AwVL^8S,@_~AwV\'^8C??YONcRaE(??i&H`D_wV%zR`E(?i&i$D^zwW)H_~AwUN^8C?@a8C???i&??Nd@awV)?i&D_~i$8C?@a8C???i&??Nd@awV)?i&D_~F@_~F_wW)H_~AwV)^8S7Na(??i&YS7NcR`E(?i&YCH_D^zwW)~F^^8CC?R`i1???i&a?i&??i&??YS(eRbi-wW/`wUNYL`~YI^H_~AwW)^(??i&YS7Nb_wW/H_~AwW/^(???i&i$(???i&YCZDb~FYS(bYCYLaYCH`wU?~AwU?^(??i&YCYLb_wV%H_~AwV%^8S;H_~AwW9^D^~F^\'^~YI^z!TM\'^Bi$\'^BZ:@^BQiY+~Z&nbBi$\'^Bi$\'^BZ:@^BQiY+~Z&nbBZ:D^BQiY,~Z&mbYT;YSN_?i&i$\'^Bi$\'^BZ:@^BQiY+~Z&nbBi$\'^Bi$\'^BZ:@^BQiY+~Z&nbBZ:D^BQiY,~Z&mbYT;YSN__~F_@_D^YT@_BQiWN{!T;(CRaE(_^D^z(C^~^bYS3i&:MiVGbYT,Ci&(CRaE(_^D^z(C^~^bYS3i&:MiVGbYT,C^~^eai&kkYU+a^YS,^BQiX+{!SN\'^8;_E(H_D^(_^~YI^z~F^z!T@7&i$i&_C^[$E(aZ%_7,c?b_@_7,YOCi&7,YOC^~^d@`a@_~i$7,c?b_@_7,YOCi&7,YOC^~^d@`a@_~AwV=D^~F^D^~F^BQiX-|i$BQiWPz!VG:kw\'wWJ!S4\'_(YS4a@_D^~F^{]/\'^9/Jlb@`^\'`~A_D_~F_|!SM7&^6YSMd@bZJ?Z1bi$`D`^~F_|]\'6b6:Z\'f@dbYS.w+awWJ~F@aD`^|!S.\'_BYTBZ*YS?``^{!U\'#aYS.w,_wWJ\'_~AiVG_{!T+9\'eca6YT+YU\'h2gh/ZJ?Z1h/eh-@f@dZJ?Z1di$b_`DaD_~F_})!SI8T+geab`^}(!S8#`kwV(8J^~i$#`kwV(8J^~i$#`kwV(8J^~i$#`kwV(8J^~Z(YJ^~Aw+P^~AwWJO^~Z(^z!T%#YS8a_wW<{!T/#a_wWJ#k_wWJ~AiVG_{!6#b`wV(8SIf?i&?bwWC?i&aiX<`8SME8T/h.^Z/kZ1_dz_`~YI_@`8SIgaRbi1Rai-aNaH`~AwW)^9\'c@a_~AwV\'^#YT/eYS.w.b#d~Z4Z1bYS3i&:Z\'iVGNeZJYS4??Z1gi$i$bckYD_wV(H`~AwW/^6`Hdb:a_wU?MdYLb`McZDa_~AwU?^6YT%g``b8S8e6YT%h-aac8S8e~YT*^~^Z8YS?c`~Aa^Z/lZ1b_YLaH`~AwV%^#cHawV(~AwW9^D_~F_#d`wV*#dHH_wV(~i$#d`wV*#dHH_wV(~YT*^~^Z8YS?``Z/kZ1__~YI_|!TB8S1`P^{]J#YJ`P__{!W(8J^z!S?-P^z]188^z!T,#b?i&`^|].8J^z]289^z!T888^z!S<iTJ]#\'iX2BZ;BZ3_BZ;BQ^{]>\'iXM7%YHDa@`C^[$E8M_7)YOYObeYHD_@^~F^{i$YH`Z%^~F^{!U.\'iXEy!U--YU:y!U;8U%YOi&`^{!U%7(_c\'i&~YN_kYDb[$E\'^BZ,b_\'^BZ,a_7/f@dc`BZ,ca7/@fdd`BZ,da~X0`^DbD`~Fa~F`}\'[%E\'_\'^7-d@ba`7-@dbba~X.`^D`D^~F_~F^{[&E7%a_C^[$E71_X2eeX1Ief_7)@`Il^~YU#k^{i$Z+m_\'^BZ,i&^~YNl_{i$i$i${]:9;BZ3^z!U&7$i&C^[$E7(?`^8MZ%_~CAf_7(?`^8MZ%_~C^~^ZC^Sbzi${!=0G`iY*_0__~YNvR$YS#Z@IlZ$`_\'^~YNkZ$_{!T:7$IlZ$_C^[$E7\'Il^9KJl`kb~YNvR$YS#Z@_b\'iY$~Kk^zi$z!U57$IlZ$_C^[$E7\'Il^9KZ$d_b~YNvR#YS#Z@_b\'iX)~Kk^zi$z]=9LYT\'`_iV8z]N\'^BYT)b_iV8YS=^GZGYU)iV8iWLz!V8YT1!U<-^z!U)8DD^z!T)8S1?Da?ca_9,b^~^ZID__|]L\'a)^~^ZID__|!T1(i&i&y!W18U(^z!VK8SAly!VO8SAky!U:(i&iX/y!B\'_BQiX9BQ^BQiY/BQiX$BQiXN{!VB\'i$z!UI\'i$z]#8SAlBZ;BZ3_BQiY&BQ^{!U08U0BZ;BZ3YTG^9;~ZC^ZABZEvCvR3y!TG7#YTI^z!TI.7&i&yM_i&z]/\'^9/Jlb@`^\'`~A_D_~F_|]\'\'^.7\'^BX(^zZ\'@a_~F@`MD`^{!S0(i&^z!S*(YS0`^{!S-(YS*b`^|]9(YS-ca_wU?|!6.\'bz9#diX=.7&X*aX*`X*_X,^zYLaH`D_~A_n.7%X)`X)_X+^zH`D_~A_m.7$X(_X*^zD_~A_l.7#X)^z~A_kYD^R@bE6_czM__6i$6Z9?NdwW2?@HcwV\'DHa6?@HbwV\'~ADHbwW5~F@a_~AwW2^6i$6C^6CYS-Z9?NgwV4wW@wW@YS0YS*`wW@wW)~FNbHa~F@a_~AwV4^6i%6C^6CZ9i$?NdwWB^~FNbHa~F@a_~AwWB^.7\'?_X)^zZ\'Nd^?bD_MH_`DH`~AwW)^9\'@a_~AwV\'^9#eiXF..7-???fb`^|z~A_n..7,??d`^{z~A_m..7+?b^zz~A_l..7*`yz~A_kYD`Z\'Nc^YOa^H`~AwW/^.7\'^7(^~X)^zMZDcaMYLb`MHa_~AwU?^.8S$X)`c^z.8GX(_bz~Z(_MYLb`Z/k`H`~CAwVL_9#diX=.7&X*aX*`X*_X,^zYLaH`D_~A_n.7%X)`X)_X+^zH`D_~A_m.7$X(_X*^zD_~A_l.7#X)^z~A_kYD^R@bE6_czM__6i$6Z9?NdwW2?@HcwV\'DHa6?@HbwV\'~ADHbwW5~F@a_~AwW2^6i$6C^6CYS-Z9?NgwV4wW@wW@YS0YS*`wW@wW)~FNbHa~F@a_~AwV4^6i%6C^6CZ9i$?NdwWB^~FNbHa~F@a_~AwWB^.7\'?_X)^zZ\'Nd^?bD_MH_`DH`~AwW)^9\'@a_~AwV\'^9#eiXF..7-???fb`^|z~A_n..7,??d`^{z~A_m..7+?b^zz~A_l..7*`yz~A_kYD`Z\'Nc^YOa^H`~AwW/^.7\'^7(^~X)^zMZDcaMYLb`MHa_~AwU?^.8S$X)`c^z.8GX(_bz~Z(_MYLb`Z/k`H`~C^~^AwV%^.\'azH`~AwW9^D_~F_.8S>b^z\'jD~An^\'iL~Am^\'i1~Al^\'i-~Ak^.88az~Z(^Z/k__~YI_{]E8F_BYF^{];8Fuy!UDiF])\'i$9)a@_BYF^9)a@_BYF^BYFvS#~CAvS#_9)a@_BYF^9)a@_BYF^BYFvS#~C^~^AvE^9)a@_BYFvS;BYFvS#~At^9)a@_BYFvS9BYFvS#~Av0^9)a@_BYFvS5BYFvS#~Au^9)a@_BYF^~L`D^~F^{!T#\'i$\'i$8T#@^BZ3D^~F^BYFvC~F^z!:8:ZG^9EvS7vF~YTJ^93ZM^BYFvF~YS)^9)i$YH^~ZO^8:YT\'^~YI^8FvLBYT#@^BZ3D^BYFvK~F^9EvLvK~Z4^9EvS;vF~Ai%^9EvS-vF~L^z]38:^8FvEBZ)i%YH^BYFvE~ZO^z!T$8T$8S%~Au^\'^~Kk^Sy!S%8S%BS\'^8T$~AvR0^~K_vC\'iX4~ZC^Z<y]?9??`^9??a^9??at~AvS;^9??av0~AvS9^9??au~AvS5^S~AvS#^9%_~AvE^\'i&~ZC^Sz]P(ZP^BS\'i&~CCKvD`(ZP^BS\'i&~CC^~^AvL_(ZP^BS\'i&~C^~^AvK^Z<y!SP(YSP^ZA\'i&BS~AvL^YS%y!K\'_8KIIvRL_YE`v3BS~i$\'_8KIIvRL_YE`v3BS~KvS.^~K_vS\'8KIIvR,_YE`v3BS~i$\'_8KIIvRL_YE`v3BS~i$\'_8KIIvRL_YE`v3BS~KvS.^~K_vS\'8KIIvR,_YE`v3BS~KvR<^~K_vR58KIIvR%_YE`v3BS~i$\'_8KIIvRL_YE`v3BS~i$\'_8KIIvRL_YE`v3BS~KvS.^~K_vS\'8KIIvR,_YE`v3BS~i$\'_8KIIvRL_YE`v3BS~i$\'_8KIIvRL_YE`v3BS~KvS.^~K_vS\'8KIIvR,_YE`v3BS~KvR<^~K_vR58KIIvR%_YE`v3BS~KvR/^~K_vR$Z<z]A8S=`\'^~^^YTN^YM?ZP^BS8MZ?i&BS~AvE^(?i&ZAwW9BS~AvJ^8S+ZA2YKkk8KkBS~AvP^Z<BS~CAvRM_8S+ZA2YKkk8KkBS~AvP^Z<BS~C^~^AvS?^\'i%BS~AvS;^\'i$BS~AvS-^Z<BS~AvF^8SPBS~AvK^\'^~Kk^YS%y]<\'^!V2^Sy!T0\'^!V2iX3\'^~AiX4^!V2^z!<8T0^8T0YU7~AiX3^\'^~AiX4^iV2y!V2iX3]C*iX4^z!W07%E\'_BZHYJc^BYGOc^PPEi$zPPEi$z!S:\'i$8S:@`^BX$D_~F_{!;\'i&(R@a_X$D_~F_{!V#i9!T.i8!S3#l`^{!TJZBl!W?8GYS\'aP_^{!V18S+YS\'k^z!W+8S$b`O^|!U@8S>`O^{!WIi9]Mi8!S+#oYD_^z!S)ZBo!UK8GYS\'aP_^{!VM8MYOi&YH^z!08MYOYH`YH^{!T58Ma8T5?fZ@bb`a_Il`~Ka_}\']K8T5i&b`^|!T3\'k\'iX4~F_\'l8T3@b@`\'l~K`^\'iX4~K__D`D^~F_~F^{!S58T3YH`YH^{!UO5YTC`^{!WH5YTE`^{!TE4YS5a_k{!TC4kYS5`^{!T-*kYS5`^{!VJ8MYS\'vC^z!V08S$b`O^|]@8S>`O^{]$i9!Hi8!M#nYD_^z]OZBn!T6i\'!S#i\'!WEj&!VEiTH!W\'iU#!UFi4!U*i*!T4\'_\'i$\'i$8T4IIvR%`YEbu@_~KvR/^~K_vR$D^~F^{!T=8T4k^\'i$~Z4^z!TN\'i$2_k~^YT=^8T=@^~AvPD^\'i$~Z4^YH^z!S/\'^8S/_`~Kak?b^JIYEu``vR%Z+u^{]G8MYS/i&^8M?YS/i&I`kvP~Kk^z!U6\'^8E__~YU8`YU6Z+m`YE_^\'l~Ak_{!VCi\'!V:i\'!VFi\'!W#i\'!V>\'lz!W&i\'!W:8E_Z+YU2``_YS&`YS&^\'k~Ak_{!S@8S@_YTD__\'_~Ak^{!U28S@`^8S@__~K__YS&`YS&^{!W63b^\'^~AKkbKk`\'k~Ak^IYE`a_Z+`^{!TD2YEZ+b``^{!S&\'^2_k~Kk^z!V?\'_\'^~K`^{!W7\'^\'_~K`^{!U85YTK^z!TK*YEZ+m`m^z!VI4k^z!UC4_kz!UB*k^z]&5K`^{!TH5K__{!U#4__{!Ni*!U45Z(^zBZ5ki#!UHPi#!T?\'^!UH?iUH^YTP^8T?Pa_\'^~U`P^O_~F_{!S=8T?iUH^z!UGiG!V.i8!T\'i9!TP#m_i$z!IZBm!SJ\'`8SJ?ca`Il^~K_k|!S\'8SJi&`^{]I\'i$9I@a_\'^~UD__D_~F_{]-iTL!TL\'i$8TL@a_\'^~AD__D_~F_{!T7\'i$8T7@`^\'_~UD`^~F_{!V/iP!P\'i$8P@`^\'_~AD`^~F_{!SB\'^8SBIl`@^~K`k{!S$8S1aYSB`^|!S>-YSB`^{!SG\'_8SG?aD_@^~F^{]%8SGi&^z!O\'_(YOa@_D^~F^{!D\'k3YD@_l~F^z!SE94^94^8SE@a@^~F^\'i$~YTOa^@^~F^{!W%8SE_^z]4*i&^z!W$8S(P^z!W38S(O^z!W.8SFP^z!V-8SFO^z!V+8SHP^z!UL8SHO^z!W=8T9P^z!WD8T9O^z!V78LO^z!W-8T2P^z!W,8T2O^z!UA8SLP^z!V98SLO^z!V68T&P^z!WF8T&O^z!S(87P^z!SF87O^z!SH8T(P^z!T98T(O^z!T21O^z!SL8SKP^z!T&8SKO^z!T(89O^z!SK88O^z]D8LP^z!L1P^z!789P^z!188P^z],j5!S1iG!)i9!-i8!(#k`^{!/ZBk!>\'i$\'i$\'i$\'i$8>OaO_~UPaP_~UYJaYJ_~Z(`\'i$~ApYJ_~Z(_\'^~^A`^{!TOi*!WA5_\'^~^Ai%^z!5*i$^z]B.\'i$*bYJ^~Z(^zz!Y\':nn:k:k:ki&vS4vS=vS9!Y0:nl:ki&vP!X%:nki&!X0:np:k:k:k:k:ki&vR#vS4vS=vS9vR$!X::np:k:k:k:k:ki&vR$vS;vS:vS6vS/!XC:nki&!XK:nv::k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS4vS(vS9vS.vS6vS9vS7vCvS,vS/vS;vCvS-vS6vCvS,vS+vS6vS*vCvRBvRKvRG!XD:nv>:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vDvRDvRAvRAvR:vR=vCvS:vS;vS5vS0vS9vS7vCvS;vS(vS/vS;vCvS,vS+vS6vS*vCvRBvRKvRG!X;:nl:ki&vO!Y%:nl:ki&vO!XL:nl:ki&vC!WO:nl:ki&vC!Y-:nvR$:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS@vR+vS=vS2vS3vR/vJvDvS4vS2vS3vR/vKvDvR2vRGvS=vR3vR4vR/vRGvS=vR3vR4vR6vRGvS=vR3vR4vR6vRGvS=vR3vR4vR9vRGvS=vR3vR4vR9vS=vR3vR4vS<vJvR0vL!X7:nn:k:k:ki&vS4vS=vS9!X,:nr:k:k:k:k:k:k:ki&vS@vS-vS0vS5vS0vS4vR$!XI:np:k:k:k:k:ki&vR$vS;vS:vS6vS/!XA:nn:k:k:ki&vS4vS=vS9!WK:nr:k:k:k:k:k:k:ki&uvS:vS,vS;vS@vS)vC!X(:nv8:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vCvR/vS/vS;vS.vS5vS,vS3vCvS,vS+vS6vS*vCvRBvRKvRGvCvMvMvM!Y#:nki&!Y):nn:k:k:ki&vS4vS=vS9!XB:nl:ki&vP!XJ:nn:k:k:ki&vS)vS0vS3!X.:no:k:k:k:ki&vS4vS*vS:vR#!X8:nki&!Y.:nl:ki&vR0!X#:nl:ki&vO!X&:nki&!Y1:nki&!Y(:nki&!XO:k:k:k:ki&w&w%w$w#!XG:nv/:k:k:k:k:k:k:k:k:k:k:k:ki&vS+vS,vS;vS*vS,vS7vS?vS,vCvS)vS0vS9!X?:nu:k:k:k:k:k:k:k:k:k:ki&vS7vS6vCvS5vS>vS6vS5vS2vS5vS<!X>:nv5:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS;vS:vS5vS6vS*vCvS,vS+vS6vS*vS5vS,vCvS;vJvS5vS(vS*!X5:nv3:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS;vS,vS.vCvS,vS+vS6vS*vS5vS,vCvS;vJvS5vS(vS*!X*:nv3:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS;vS,vS:vCvS,vS+vS6vS*vS5vS,vCvS;vJvS5vS(vS*!WM:nv4:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS3vS3vS(vS*vCvS,vS+vS6vS*vS5vS,vCvS;vJvS5vS(vS*!X\':nv4:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS7vS4vS<vS1vCvS,vS+vS6vS*vS5vS,vCvS;vJvS5vS(vS*!X1:nl:ki&vS&!X6:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&:k:ki&v7wSA:k:ki&v6wF:k:ki&v5wU7:k:ki&v4x+:k:ki&v3wE:k:ki&v2w2:k:ki&v1w3:k:ki&v0w4:k:ki&v/w*:k:ki&v.xH:k:ki&ux5:k:ki&twG:k:ki&swJ:k:ki&rw9:k:ki&qw8:k:ki&px(:k:ki&ow.:k:ki&nw,:k:ki&mw+:k:ki&lw\':k:ki&kw#!X@:nv7:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS;vS5vS(vS;vS:vS5vS6vS*vCvS+vS3vS0vS<vS)vCvS;vJvS5vS(vS*!XH:k:k:ki&i&i%i$!XP:ki&k!Y+:nv0:k:k:k:k:k:k:k:k:k:k:k:k:ki&uvR/vS:vS;vS9vS6vS7vS?vS,vCvMvMvM!Y,:nv1:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&uvR/vS,vS+vS6vS*vCvRBvRKvRGvCvMvMvM!WN:nv?:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS5vS6vS0vS;vS(vS3vS0vS7vS4vS6vS*vCvS(vS3vCvS,vS+vCvS;vS<vS)vS,vS+vCvS;vS<vS6vRI!X+:nvR#:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS:vS;vS9vS6vS7vS?vS,vPvS/vS;vS0vS>vPvS:vS9vS7vS?vS,vPvS7vS4vS6vS*vCvS,vS+vCvS;vS<vS)vS,vS+vCvS<vS(vCvS+vS5vS,vS9vCvS,vS:vCvS5vRD!X-:nv1:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS,vS3vS*vS<vS6vS)vCvS(vS3vCvS:vS5vS(vR9!WP:nvR$:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS:vS5vS0vS6vS4vCvS<vS(vCvS:vS;vS9vS6vS7vS?vS,vPvS;vS*vS(vS9vS;vS?vS,vCvS<vS+vCvS;vS<vS)vS,vS+vCvS<vS(vCvS+vS5vS,vS9vCvS,vS:vCvS5vRD!X<:ki&wWC!X2:k:k:k:ki&:ki&wUEi&wUEwW)!XM:nki&!XE:nki&!Y*:nl:ki&vR$!Y$:nm:k:ki&vR$vR#!X):nki&!WL:nn:k:k:ki&vR5vR5vR5!X/:nki&!X9:nv.:k:k:k:k:k:k:k:k:k:k:ki&uvR#vS@vS3vS3vS(vS<vS5vS(vS4vC!Y/:nvE:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vCvS.vS5vS0vS5vS5vS<vS9vCvS@vS9vS;vCvS6vS;vCvS;vS5vS(vS>vCvS;vS/vS.vS0vS4vCvS<vS6vRNvCvMvMvM!X$:nvO:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&uvR#vS+vS,vS0vS-vS0vS5vS0vS4vCvS;vS6vS5vCvS:vS(vS>vCvS,vS+vS6vS*vCvS+vS,vS;vS(vS9vS,vS5vS,vS.vCvS,vS/vS;vCvS6vS:vCvMvMvM!XN:nvR/:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&uvS4vS,vS;vS:vS@vS:vCvS,vS4vS,vS/vS*vRHvCvS:vS0vS/vS;vCvS/vS;vS0vS>vCvS+vS,vS;vS9vS6vS7vS7vS<vS:vCvS;vS6vS5vCvS:vS0vCvS5vS6vS0vS;vS(vS*vS0vS-vS0vS5vS0vRBvCvMvMvM!Y&:nl:ki&vC!X=:nv5:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS:vS;vS5vS,vS4vS<vS.vS9vS(vCvS@vS5vS(vS4vCvS6vS6vS;!XF:nv6:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:k:ki&vS:vS9vS,vS;vS,vS4vS(vS9vS(vS7vCvS@vS5vS(vS4vCvS6vS6vS;!X3Imk!X4Ilk!\':lkl!+:lkm!,:lkn!.:lko](:lkp!8:lkq!9:lkr!J:lks!G:lkt]5:lku]H:lkv.!*:lkv/!4:lkv0!3:lkv1!2:lkv2!E:lkv3]+:lkv4!U7:lkv5!F:lkv6!SA:lkv7y") ;; RVM code that prints HELLO!

(cond-expand
  (gambit
   ;;(define-cond-expand-feature debug)
   (declare (standard-bindings) (block) (not safe)))
  (else))

(define pair-type      0)
(define procedure-type 1)
(define symbol-type    2)
(define string-type    3)
(define vector-type    4)
(define singleton-type 5)

(define (_rib? x) (vector? x))
(define (_rib x y z) (vector x y z))
(define (_field0 x) (vector-ref x 0))
(define (_field1 x) (vector-ref x 1))
(define (_field2 x) (vector-ref x 2))
(define (_field0-set! x y) (vector-set! x 0 y))
(define (_field1-set! x y) (vector-set! x 1 y))
(define (_field2-set! x y) (vector-set! x 2 y))

(define (instance? type)
  (lambda (x) (and (_rib? x) (eqv? (_field2 x) type))))

(define _pair? (instance? pair-type))
(define (_cons car cdr) (_rib car cdr pair-type))
(define (_car pair) (_field0 pair))
(define (_cdr pair) (_field1 pair))
(define (_set-car! pair x) (_field0-set! pair x))

(define (_list->string lst) (_rib lst (_length lst) string-type))

(define (_string->uninterned-symbol str) (_rib _false str symbol-type))

(define _false (_rib 0 0 singleton-type))
(define _true  (_rib 0 0 singleton-type))
(define _nil   (_rib 0 0 singleton-type))

(define (_list-tail lst i)
  (if (< 0 i)
      (_list-tail (_cdr lst) (- i 1))
      lst))

(define (_length lst)
  (if (_pair? lst)
      (+ 1 (_length (_cdr lst)))
      0))

(define pos 0)

(define (get-byte)
  (let ((x (char->integer (string-ref input pos))))
    (set! pos (+ pos 1))
    x))

(define (decode)

  (define eb/2 46) ;; half of encoding base (92)

  (define (get-code)
    (let ((x (- (get-byte) 35)))
      (if (< x 0) 57 x)))

  (define (get-int n)
    (let ((x (get-code))
          (y (* n eb/2)))
      (if (< x eb/2)
          (+ y x)
          (get-int (+ y (- x eb/2))))))

  (define (build-symtbl)

    (define (add-symbol chars symtbl)
      (_cons (_string->uninterned-symbol (_list->string chars))
             symtbl))

    (let loop1 ((n (get-int 0)) (symtbl _nil))
      (if (< 0 n)
          (loop1 (- n 1) (add-symbol _nil symtbl))
          (let loop2 ((symtbl symtbl))
            (let loop3 ((chars _nil))
              (let ((x (get-byte)))
                (if (= x 44) ;; #\, separates symbols
                    (loop2 (add-symbol chars symtbl))
                    (if (= x 59) ;; #\; terminates symbol list
                        (add-symbol chars symtbl)
                        (loop3 (_cons x chars))))))))))

  (let ((symtbl (build-symtbl)))

    (define (decode-loop stack)

      (define (sym n)
        (_car (_list-tail symtbl n)))

      (define (add-instruction op opnd stack)
;;        (pp (list (vector-ref '#(jump/call set get const if) op) opnd))
        (_set-car! stack (_rib op opnd (_car stack)))
        (decode-loop stack))

      (let ((x (get-code)))
        (let loop ((op 0) (n x))
          (let ((d (vector-ref '#(20 30 0 10 11 4) op)))
            (if (< (+ 2 d) n)
                (loop (+ op 1) (- n (+ d 3)))
                (if (< 90 x)
                    (add-instruction 4 ;; if
                                     (_car stack)
                                     (_cdr stack))
                    (let ((stack (if (= op 0) (_cons 0 stack) stack))
                          (opnd (if (< n d)
                                    (if (< op 3)
                                        (sym n)
                                        n)
                                    (if (= n d)
                                        (get-int 0)
                                        (sym (get-int (- (- n d) 1)))))))
                      (if (< 4 op)
                          (let ((proc (_rib
                                       (_rib opnd 0 (_car stack))
                                       _nil
                                       procedure-type))
                                (stack (_cdr stack)))
                            (if (_rib? stack)
                                (add-instruction 3 ;; const-proc
                                                 proc
                                                 stack)
                                proc))
                          (add-instruction (if (< 0 op) (- op 1) 0)
                                           opnd
                                           stack)))))))))

    (let ((main-proc (decode-loop 0)))

      ;; set predefined globals (always 4 first in the symbol table)

      (define (set-global val)
        (_field0-set! (_car symtbl) val)
        (set! symtbl (_cdr symtbl)))
;;(pp (list 'pos= pos))
;;(pp (list 'symtbl= (convert symtbl)))

      (set-global (_rib 0 symtbl procedure-type)) ;; rib  = primitive 0
      (set-global _false) ;; false  = #f
      (set-global _true)  ;; true   = #t
      (set-global _nil)   ;; nil    = ()

      main-proc)))

(cond-expand
  (debug

   (define (trace-instruction name opnd stack)
     (display "--- ")
     (display name)
     (display " ")
     (if opnd
         (begin
           (write (convert opnd))
           (display " ")))
     (write (show-stack stack))
     (newline))

   (define (convert obj)
     (cond ((eqv? obj _false)
            #f)
           ((eqv? obj _true)
            #t)
           ((eqv? obj _nil)
            (list))
           ((not (_rib? obj))
            obj)
           ((eqv? (_field2 obj) pair-type)
            (cons (convert (_field0 obj)) (convert (_field1 obj))))
           ((eqv? (_field2 obj) procedure-type)
            '<procedure>)
           ((eqv? (_field2 obj) symbol-type)
            (string->symbol (convert (_field1 obj))))
           ((eqv? (_field2 obj) string-type)
            (list->string (map integer->char (convert (_field0 obj)))))
           ((eqv? (_field2 obj) vector-type)
            (list->vector (convert (_field0 obj))))
           (else
            '<unknown>)))

   (define (show-stack stack)
     (if (_pair? stack)
         (cons (convert (_car stack))
               (show-stack (_cdr stack)))
         (if (eqv? 0 stack)
             (list)
             (list 'stack: (show-stack (_field0 stack))
                   'pc: (convert (_field2 stack)))))))
  (else
   (define (trace-instruction name opnd stack)
     0)))

(define (run pc stack)

  (define (get-cont stack)
    (let loop ((stack stack))
      (if (_rib? (_field2 stack)) stack (loop (_cdr stack)))))

  (define (get-var opnd)
    (_field0 (if (_rib? opnd) opnd (_list-tail stack opnd))))

  (define (set-var opnd val)
    (_field0-set! (if (_rib? opnd) opnd (_list-tail stack opnd)) val))

  (let ((instr (_field0 pc))
        (opnd (_field1 pc))
        (next (_field2 pc)))
    (case instr

      ((0) ;; jump/call
       (trace-instruction (if (eqv? 0 next) "jump" "call") opnd stack)
       (let* ((proc (get-var opnd))
              (code (_field0 proc)))
         (if (_rib? code)

             ;; calling a lambda
             (let ((new-cont (_rib 0 proc 0)))
               (let loop ((nargs (_field0 code))
                          (new-stack new-cont)
                          (stack stack))
                 (if (< 0 nargs)
                     (loop (- nargs 1)
                           (_cons (_car stack) new-stack)
                           (_cdr stack))
                     (begin
                       (if (_rib? next) ;; non-tail call?
                           (begin
                             (_field0-set! new-cont stack)
                             (_field2-set! new-cont next))
                           (let ((k (get-cont stack)))
                             (_field0-set! new-cont (_field0 k))
                             (_field2-set! new-cont (_field2 k))))
                       (run (_field2 code)
                            new-stack)))))

             ;; calling a primitive
             (let ((stack ((vector-ref primitives code) stack)))
               (run (if (_rib? next) ;; non-tail call?
                        next
                        (let ((cont (get-cont stack)))
                          (_field1-set! stack (_field0 cont))
                          (_field2 cont)))
                    stack)))))

      ((1) ;; set
       (trace-instruction "set" opnd stack)
       (set-var opnd (_car stack))
       (run next
            (_cdr stack)))

      ((2) ;; get
       (trace-instruction "get" opnd stack)
       (run next
            (_cons (get-var opnd) stack)))

      ((3) ;; const
       (trace-instruction "const" opnd stack)
       (run next
            (_cons opnd stack)))

      ((4) ;; if
       (trace-instruction "if" #f stack)
       (run (if (eqv? (_car stack) _false) next opnd)
            (_cdr stack))))))

(define (prim0 f)
  (lambda (stack)
    (_cons (f) stack)))

(define (prim1 f)
  (lambda (stack)
    (let* ((x (_car stack)) (stack (_cdr stack)))
      (_cons (f x) stack))))

(define (prim2 f)
  (lambda (stack)
    (let* ((y (_car stack)) (stack (_cdr stack))
           (x (_car stack)) (stack (_cdr stack)))
      (_cons (f x y) stack))))

(define (prim3 f)
  (lambda (stack)
    (let* ((z (_car stack)) (stack (_cdr stack))
           (y (_car stack)) (stack (_cdr stack))
           (x (_car stack)) (stack (_cdr stack)))
      (_cons (f x y z) stack))))

(define (boolean x)
  (if x _true _false))

(define primitives
  (vector (prim3 _rib)             ;; 0
          (prim1 (lambda (x) x))   ;; 1
          _cdr                     ;; 2
          (prim2 (lambda (y x) x)) ;; 3

          (lambda (stack) ;; 4
            (let* ((x (_car stack)) (stack (_cdr stack)))
              (_cons (_rib (_field0 x) stack procedure-type) stack)))

          (prim1 (lambda (x) (boolean (_rib? x)))) ;; 5
          (prim1 _field0) ;; 6
          (prim1 _field1) ;; 7
          (prim1 _field2) ;; 8
          (prim2 (lambda (x y) (_field0-set! x y) y)) ;; 9
          (prim2 (lambda (x y) (_field1-set! x y) y)) ;; 10
          (prim2 (lambda (x y) (_field2-set! x y) y)) ;; 11
          (prim2 (lambda (x y) (boolean (eqv? x y)))) ;; 12
          (prim2 (lambda (x y) (boolean (< x y)))) ;; 13
          (prim2 +) ;; 14
          (prim2 -) ;; 15
          (prim2 *) ;; 16
          (prim2 quotient) ;; 17

          (prim0 (lambda () ;; 18
                   (if (< pos (string-length input))
                       (get-byte)
                       (let ((c (read-char)))
                         (if (char? c) (char->integer c) -1)))))

          (prim1 (lambda (x) ;; 19
                   (write-char (integer->char x))
                   x))

          (prim1 (lambda (x) ;; 20
                   (exit x)))))

(let ((x (decode)))
  (run (_field2 (_field0 x)) ;; instruction stream of main procedure
       (_rib 0 0 (_rib 5 0 0)))) ;; primordial continuation = halt
